var HTMLRasterizer;!function(e){let t,n,r,o;!function(t){function n(e){const t=/\.([^\.\/]*?)$/g.exec(e);return t?t[1]:""}function r(e){return new Promise((function(t){const n=window.atob(e.toDataURL().split(",")[1]),r=n.length,o=new Uint8Array(r);for(let e=0;e<r;e++)o[e]=n.charCodeAt(e);t(new Blob([o],{type:"image/png"}))}))}var o;function i(e,t){const n=window.getComputedStyle(e).getPropertyValue(t);return parseFloat(n.replace("px",""))}t.mimes=function(){const e="application/font-woff",t="image/jpeg";return{woff:e,woff2:e,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:t,jpeg:t,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml"}}(),t.parseExtension=n,t.mimeType=function(e){const r=n(e).toLowerCase();return t.mimes[r]||""},t.isDataUrl=function(e){return-1!==e.search(/^(data:)/)},t.toBlob=r,t.canvasToBlob=function(e){return e.toBlob?new Promise((function(t){e.toBlob(t)})):r(e)},t.resolveUrl=function(e,t){const n=document.implementation.createHTMLDocument(),r=n.createElement("base");n.head.appendChild(r);const o=n.createElement("a");return n.body.appendChild(o),r.href=t,o.href=e,o.href},t.uid=(o=0,function(){return"u"+("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4)+o++}),t.makeImage=function(e){return new Promise((function(t,n){const r=new Image;r.onload=function(){t(r)},r.onerror=n,r.src=e}))},t.getAndEncode=function(t){return e.impl.options.cacheBust&&(t+=(/\?/.test(t)?"&":"?")+(new Date).getTime()),new Promise((function(n){const r=new XMLHttpRequest;let o;if(r.onreadystatechange=function(){if(4!==r.readyState)return;if(200!==r.status)return void(o?n(o):i("cannot fetch resource: "+t+", status: "+r.status));const e=new FileReader;e.onloadend=function(){const t=e.result.split(/,/)[1];n(t)},e.readAsDataURL(r.response)},r.ontimeout=function(){o?n(o):i("timeout of 30000ms occured while fetching resource: "+t)},r.responseType="blob",r.timeout=3e4,r.open("GET",t,!0),r.send(),e.impl.options.imagePlaceholder){const t=e.impl.options.imagePlaceholder.split(/,/);t&&t[1]&&(o=t[1])}function i(e){console.error(e),n("")}}))},t.dataAsUrl=function(e,t){return"data:"+t+";base64,"+e},t.escape=function(e){return e.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1")},t.delay=function(e){return function(t){return new Promise((function(n){setTimeout((function(){n(t)}),e)}))}},t.asArray=function(e){const t=[],n=e.length;for(let r=0;r<n;r++)t.push(e[r]);return t},t.escapeXhtml=function(e){return e.replace(/#/g,"%23").replace(/\n/g,"%0A")},t.width=function(e){const t=i(e,"border-left-width"),n=i(e,"border-right-width");return e.scrollWidth+t+n},t.height=function(e){const t=i(e,"border-top-width"),n=i(e,"border-bottom-width");return e.scrollHeight+t+n},t.px=i}(t||(t={})),function(e){const n=/url\(['"]?([^'"]+?)['"]?\)/g;function r(e){return-1!==e.search(n)}function o(e){const r=[];let o;for(;null!==(o=n.exec(e));)r.push(o[1]);return r.filter((function(e){return!t.isDataUrl(e)}))}function i(e,n,r,o){return Promise.resolve(n).then((function(e){return r?t.resolveUrl(e,r):e})).then(o||t.getAndEncode).then((function(e){return t.dataAsUrl(e,t.mimeType(n))})).then((function(r){return e.replace(function(e){return new RegExp("(url\\(['\"]?)("+t.escape(e)+")(['\"]?\\))","g")}(n),"$1"+r+"$3")}))}e.impl={readUrls:o,inline:i},e.shouldProcess=r,e.inlineAll=function(e,t,n){return r(e)?Promise.resolve(e).then(o).then((function(r){let o=Promise.resolve(e);return r.forEach((function(e){o=o.then((function(r){return i(r,e,t,n)}))})),o})):Promise.resolve(e)}}(n||(n={})),function(e){function r(e){return{inline:function(n){return t.isDataUrl(e.src)?Promise.resolve():Promise.resolve(e.src).then(n||t.getAndEncode).then((function(n){return t.dataAsUrl(n,t.mimeType(e.src))})).then((function(t){return new Promise((function(n,r){e.onload=()=>n(),e.onerror=r,e.src=t}))}))}}}e.impl={newImage:r},e.inlineAll=function e(o){return o instanceof Element?function(e){const t=e.style.getPropertyValue("background");return t?n.inlineAll(t).then((function(t){e.style.setProperty("background",t,e.style.getPropertyPriority("background"))})).then((function(){return e})):Promise.resolve(e)}(o).then((function(){return o instanceof HTMLImageElement?r(o).inline():Promise.all(t.asArray(o.childNodes).map((function(t){return e(t)})))})):Promise.resolve(o)}}(r||(r={})),function(e){function r(e){return Promise.resolve(t.asArray(e.styleSheets)).then((function(e){const n=[];return e.forEach((function(e){try{t.asArray(e.cssRules||[]).forEach((e=>n.push(e)))}catch(t){console.log("Error while reading CSS rules from "+e.href,""+t)}})),n})).then((function(e){return e.filter((function(e){return e.type===CSSRule.FONT_FACE_RULE})).filter((function(e){return n.shouldProcess(e.style.getPropertyValue("src"))}))})).then((function(e){return e.map(r)}));function r(e){return{resolve:function(){var t;const r=null!==(t=(e.parentStyleSheet||{}).href)&&void 0!==t?t:void 0;return n.inlineAll(e.cssText,r)},src:function(){return e.style.getPropertyValue("src")}}}}e.impl={readAll:r},e.resolveAll=function(){return r(document).then((function(e){return Promise.all(e.map((function(e){return e.resolve()})))})).then((function(e){return e.join("\n")}))}}(o||(o={}));const i={imagePlaceholder:void 0,cacheBust:!1};function c(n,r={}){return function(t){void 0===t.imagePlaceholder?e.impl.options.imagePlaceholder=i.imagePlaceholder:e.impl.options.imagePlaceholder=t.imagePlaceholder;void 0===t.cacheBust?e.impl.options.cacheBust=i.cacheBust:e.impl.options.cacheBust=t.cacheBust}(r=r||{}),Promise.resolve(n).then((function(e){return s(e,r.filter,!0)})).then(l).then(a).then((function(e){r.bgcolor&&(e.style.backgroundColor=r.bgcolor);r.width&&(e.style.width=r.width+"px");r.height&&(e.style.height=r.height+"px");r.style&&Object.keys(r.style).forEach((function(t){e.style[t]=r.style[t]}));return e})).then((function(e){return function(e,n,r){return Promise.resolve(e).then((function(e){return e.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),(new XMLSerializer).serializeToString(e)})).then(t.escapeXhtml).then((function(e){return'<foreignObject x="0" y="0" width="100%" height="100%">'+e+"</foreignObject>"})).then((function(e){return'<svg xmlns="http://www.w3.org/2000/svg" width="'+n+'" height="'+r+'">'+e+"</svg>"})).then((function(e){return"data:image/svg+xml;charset=utf-8,"+e}))}(e,r.width||t.width(n),r.height||t.height(n))}))}function u(e,n={}){return c(e,n).then(t.makeImage).then(t.delay(100)).then((function(r){const o=function(e){const r=document.createElement("canvas");if(r.width=n.width||t.width(e),r.height=n.height||t.height(e),n.bgcolor){const e=r.getContext("2d");e.fillStyle=n.bgcolor,e.fillRect(0,0,r.width,r.height)}return r}(e);return o.getContext("2d").drawImage(r,0,0),o}))}function s(e,n,r){return r||!n||n(e)?Promise.resolve(e).then((function(e){return e instanceof HTMLCanvasElement?t.makeImage(e.toDataURL()):Promise.resolve(e.cloneNode(!1))})).then((function(r){return function(e,n,r){const o=e.childNodes;return 0===o.length?Promise.resolve(n):i(n,t.asArray(o),r).then((function(){return n}));function i(e,t,n){let r=Promise.resolve();return t.forEach((function(t){r=r.then((function(){return s(t,n)})).then((function(t){t&&e.appendChild(t)}))})),r}}(e,r,n)})).then((function(n){return function(e,n){return n instanceof Element?Promise.resolve().then(r).then(o).then(i).then(c).then((function(){return n})):n;function r(){function r(e,n){function r(e,n){t.asArray(e).forEach((function(t){n.setProperty(t,e.getPropertyValue(t),e.getPropertyPriority(t))}))}e.cssText?n.cssText=e.cssText:r(e,n)}r(window.getComputedStyle(e),n.style)}function o(){function r(r){const o=window.getComputedStyle(e,r),i=o.getPropertyValue("content");if(""===i||"none"===i)return;const c=t.uid();n.className=n.className+" "+c;const u=document.createElement("style");function s(e,n,r){const o="."+e+":"+n,i=r.cssText?c(r):u(r);return document.createTextNode(o+"{"+i+"}");function c(e){const t=e.getPropertyValue("content");return e.cssText+" content: "+t+";"}function u(e){return t.asArray(e).map(n).join("; ")+";";function n(t){return t+": "+e.getPropertyValue(t)+(e.getPropertyPriority(t)?" !important":"")}}}u.appendChild(s(c,r,o)),n.appendChild(u)}[":before",":after"].forEach((function(e){r(e)}))}function i(){e instanceof HTMLTextAreaElement&&(n.innerHTML=e.value),e instanceof HTMLInputElement&&n.setAttribute("value",e.value)}function c(){n instanceof SVGElement&&(n.setAttribute("xmlns","http://www.w3.org/2000/svg"),n instanceof SVGRectElement&&["width","height"].forEach((function(e){const t=n.getAttribute(e);t&&n.style.setProperty(e,t)})))}}(e,n)})):Promise.resolve()}function l(e){return o.resolveAll().then((function(t){const n=document.createElement("style");return e.appendChild(n),n.appendChild(document.createTextNode(t)),e}))}function a(e){return r.inlineAll(e).then((function(){return e}))}e.impl={fontFaces:o,images:r,util:t,inliner:n,options:{}},e.toSvg=c,e.toPixelData=function(e,n={}){return u(e,n||{}).then((function(n){return n.getContext("2d").getImageData(0,0,t.width(e),t.height(e)).data}))},e.toPng=function(e,t={}){return u(e,t||{}).then((function(e){return e.toDataURL()}))},e.toJpeg=function(e,t={}){return u(e,t=t||{}).then((function(e){return e.toDataURL("image/jpeg",t.quality||1)}))},e.toBlob=function(e,n={}){return u(e,n||{}).then(t.canvasToBlob)}}(HTMLRasterizer||(HTMLRasterizer={}));